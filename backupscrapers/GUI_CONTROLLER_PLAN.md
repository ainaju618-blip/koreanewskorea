# 스크래퍼 GUI 컨트롤러 개발 계획서

> **버전**: v1.0
> **작성일**: 2025-12-26
> **프로젝트**: Korea NEWS Scraper Control System

---

## 📋 개요 (Overview)

### 목적
Python/Playwright 기반 스크래핑 봇들을 통합 관리하는 GUI 애플리케이션 개발

### 현재 인프라
```
D:\cbt\koreanews\scrapers\
├── naju\           # 나주시 보도자료 스크래퍼 (운영중)
├── korea_kr\       # 정부 보도자료 스크래퍼 (개발예정)
├── [region]\       # 추가 지역 스크래퍼들
└── utils\          # 공통 유틸리티
    ├── api_client.py
    ├── scraper_utils.py
    ├── content_cleaner.py
    ├── category_detector.py
    └── error_collector.py
```

---

## 🎯 핵심 기능 (Core Features)

### 1. 스크래퍼 관리
| 기능 | 설명 | 우선순위 |
|------|------|----------|
| 스크래퍼 목록 | 등록된 모든 스크래퍼 표시 | P0 |
| 시작/중지 | 개별 스크래퍼 실행 제어 | P0 |
| 일괄 실행 | 선택된 스크래퍼들 동시 실행 | P1 |
| 상태 모니터링 | 실시간 실행 상태 표시 | P0 |

### 2. 스케줄링
| 기능 | 설명 | 우선순위 |
|------|------|----------|
| Cron 스케줄 | 정기 실행 일정 설정 | P1 |
| 간격 설정 | 실행 주기 (매시간, 매일 등) | P1 |
| 다음 실행 표시 | 예정된 다음 실행 시간 | P2 |

### 3. 로그 및 결과
| 기능 | 설명 | 우선순위 |
|------|------|----------|
| 실시간 로그 | 스크래퍼 출력 스트리밍 | P0 |
| 실행 히스토리 | 과거 실행 기록 조회 | P1 |
| 수집 통계 | 기사 수집 현황 대시보드 | P1 |
| 에러 알림 | 실패 시 알림 표시 | P0 |

### 4. 설정 관리
| 기능 | 설명 | 우선순위 |
|------|------|----------|
| 파라미터 편집 | --days, --max-articles 등 | P1 |
| 프리셋 저장 | 자주 쓰는 설정 저장 | P2 |
| 환경변수 관리 | API 키 등 보안 설정 | P2 |

---

## 🛠️ 기술 스택 선택

### Option A: PyQt6 (권장)
```
장점:
✅ Python 네이티브 - 기존 스크래퍼와 완벽 호환
✅ 크로스 플랫폼 (Windows/Mac/Linux)
✅ 풍부한 위젯과 현대적 UI
✅ 설치 파일 배포 용이 (PyInstaller)

단점:
❌ 웹 기반 대비 UI 커스텀 제한
❌ 러닝커브 존재
```

### Option B: Electron + React
```
장점:
✅ 현대적인 웹 기반 UI
✅ 기존 koreanews 프론트엔드 경험 활용
✅ 풍부한 UI 컴포넌트 생태계

단점:
❌ Python 스크래퍼와 IPC 통신 필요
❌ 앱 용량 큼 (~100MB+)
❌ 복잡한 빌드 설정
```

### Option C: Streamlit (빠른 개발)
```
장점:
✅ 가장 빠른 개발 속도
✅ Python만으로 구현
✅ 데이터 시각화 용이

단점:
❌ 웹 브라우저 필요
❌ 복잡한 UI 구현 어려움
❌ 데스크톱 앱 느낌 부족
```

### 📌 추천: **PyQt6**
- 기존 Python 스크래퍼와의 통합이 가장 자연스러움
- 단독 실행 가능한 데스크톱 앱 생성 가능
- 주인님 PC에서 바로 실행 가능

---

## 📐 아키텍처 설계

### 레이어 구조
```
┌─────────────────────────────────────────────────┐
│                   GUI Layer                      │
│   (PyQt6 Widgets: 메인윈도우, 대시보드, 설정)    │
├─────────────────────────────────────────────────┤
│               Controller Layer                   │
│   (스크래퍼 매니저, 스케줄러, 로그 핸들러)       │
├─────────────────────────────────────────────────┤
│                Process Layer                     │
│   (subprocess로 스크래퍼 실행, 출력 캡처)        │
├─────────────────────────────────────────────────┤
│              Scraper Layer (기존)                │
│   (naju_scraper.py, korea_kr_scraper.py 등)      │
└─────────────────────────────────────────────────┘
```

### 디렉토리 구조 (신규)
```
D:\cbt\koreanews\scrapers\
├── gui\
│   ├── __init__.py
│   ├── main.py              # 앱 진입점
│   ├── main_window.py       # 메인 윈도우
│   ├── widgets\
│   │   ├── scraper_list.py  # 스크래퍼 목록 위젯
│   │   ├── log_viewer.py    # 로그 뷰어
│   │   ├── scheduler.py     # 스케줄 설정
│   │   └── dashboard.py     # 통계 대시보드
│   ├── controllers\
│   │   ├── scraper_manager.py   # 스크래퍼 프로세스 관리
│   │   ├── scheduler_manager.py # 스케줄 관리
│   │   └── log_handler.py       # 로그 수집/표시
│   ├── models\
│   │   ├── scraper.py       # 스크래퍼 데이터 모델
│   │   └── schedule.py      # 스케줄 데이터 모델
│   └── resources\
│       ├── styles.qss       # Qt 스타일시트
│       └── icons\           # 아이콘 리소스
├── config\
│   ├── scrapers.json        # 스크래퍼 등록 설정
│   └── schedules.json       # 스케줄 설정
└── logs\
    └── gui.log              # GUI 앱 로그
```

---

## 🖥️ UI 설계

### 메인 윈도우 레이아웃
```
┌──────────────────────────────────────────────────────────┐
│  📰 Korea NEWS Scraper Controller              [─][□][×] │
├──────────────────────────────────────────────────────────┤
│  [▶ 전체실행]  [⏹ 전체중지]  [⚙ 설정]        상태: 🟢 정상 │
├────────────────────┬─────────────────────────────────────┤
│                    │                                     │
│  ┌──────────────┐  │  📊 대시보드                        │
│  │ 스크래퍼 목록 │  │  ┌─────────────────────────────┐   │
│  ├──────────────┤  │  │ 오늘 수집: 127건            │   │
│  │ ✅ naju      │  │  │ 이번주: 892건               │   │
│  │ 🟡 korea_kr  │  │  │ 마지막 실행: 10분 전        │   │
│  │ ⚪ mokpo     │  │  └─────────────────────────────┘   │
│  │ ⚪ yeosu     │  │                                     │
│  └──────────────┘  │  📋 실시간 로그                     │
│                    │  ┌─────────────────────────────┐   │
│  선택: naju        │  │ [14:32:05] 나주 수집 시작    │   │
│  ┌──────────────┐  │  │ [14:32:08] 기사 5개 발견     │   │
│  │ [▶ 실행]     │  │  │ [14:32:15] 상세 수집 중...   │   │
│  │ [⏹ 중지]     │  │  │ [14:33:02] 완료: 5건 저장    │   │
│  │ [📅 예약]    │  │  └─────────────────────────────┘   │
│  │ [⚙ 설정]    │  │                                     │
│  └──────────────┘  │                                     │
└────────────────────┴─────────────────────────────────────┘
```

### 상태 아이콘
| 아이콘 | 상태 | 설명 |
|--------|------|------|
| 🟢 | Running | 실행 중 |
| 🟡 | Scheduled | 예약됨 |
| ⚪ | Idle | 대기 중 |
| 🔴 | Error | 에러 발생 |
| ⏸️ | Paused | 일시정지 |

---

## 📅 개발 일정

### Phase 1: 기초 구축 (3일)
- [ ] PyQt6 프로젝트 셋업
- [ ] 메인 윈도우 레이아웃
- [ ] 스크래퍼 목록 위젯
- [ ] 기본 스타일링

### Phase 2: 핵심 기능 (4일)
- [ ] 스크래퍼 실행/중지 (subprocess)
- [ ] 실시간 로그 스트리밍
- [ ] 상태 모니터링
- [ ] 에러 핸들링

### Phase 3: 스케줄링 (2일)
- [ ] APScheduler 통합
- [ ] 스케줄 UI
- [ ] 설정 저장/로드

### Phase 4: 대시보드 (2일)
- [ ] 수집 통계 표시
- [ ] 히스토리 조회
- [ ] 차트 시각화

### Phase 5: 마무리 (2일)
- [ ] PyInstaller 빌드
- [ ] 설치 파일 생성
- [ ] 문서화

**예상 총 소요: 약 2주**

---

## 📦 의존성 패키지

```python
# requirements-gui.txt
PyQt6>=6.6.0
PyQt6-Charts>=6.6.0      # 차트 시각화
APScheduler>=3.10.0       # 스케줄링
psutil>=5.9.0             # 프로세스 모니터링
```

---

## 🚀 빌드 및 배포

### PyInstaller 설정
```python
# gui.spec
a = Analysis(
    ['gui/main.py'],
    pathex=['D:/cbt/koreanews/scrapers'],
    datas=[
        ('config', 'config'),
        ('gui/resources', 'resources'),
    ],
    hiddenimports=['playwright'],
)
```

### 빌드 명령어
```bash
# 개발 실행
python gui/main.py

# 빌드
pyinstaller --onefile --windowed --name "ScraperController" gui/main.py

# 결과물: dist/ScraperController.exe
```

---

## ⚠️ 고려사항

### 보안
- API 키는 환경변수 또는 암호화 저장
- 로그에 민감정보 노출 방지

### 성능
- 다중 스크래퍼 동시 실행 시 리소스 관리
- 로그 버퍼 크기 제한 (메모리 관리)

### 확장성
- 새 스크래퍼 추가 시 설정 파일만 수정
- 플러그인 구조로 기능 확장 가능

---

## 🔗 관련 문서

- [나주 스크래퍼 알고리즘](./naju/ALGORITHM.md)
- [스크래퍼 공통 유틸리티](./utils/README.md)

---

*이 계획서는 주인님 승인 후 구현을 시작합니다.*
