# 로컬 홈페이지 미러링 작업 기록

> **목적**: 홈페이지 미러링 및 복제 작업 진행 기록
> **시작일**: 2025-12-28
> **담당**: Claude AI + 주인님
> **상태**: ACTIVE - 통합 아키텍처 진행 중

---

## 🎯 최신 아키텍처 (2025-12-30 확정)

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│                    koreanewskorea.com (통합 플랫폼)                         │
│                    폴더: koreanewskorea/                                    │
│                                                                             │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│   /                    →  중앙뉴스 (전국 정책, 정부 보도자료)              │
│   /policy/             →  정책 브리핑, KTV                                 │
│   /tour/               →  전국 관광                                        │
│                                                                             │
│   /gwangju/            →  광주 지역뉴스                                    │
│   /mokpo/              →  목포/영암/무안/신안 지역뉴스                     │
│   /yeosu/              →  여수 지역뉴스                                    │
│   /suncheon/           →  순천 지역뉴스                                    │
│   /naju/               →  나주/화순 지역뉴스                               │
│   /gwangyang/          →  광양/곡성/구례 지역뉴스                          │
│   /damyang/            →  담양/함평/영광/장성 지역뉴스                     │
│   /goheung/            →  고흥/보성/장흥/강진 지역뉴스                     │
│   /haenam/             →  해남/완도/진도 지역뉴스                          │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────┐
│  IP 지오로케이션 자동 감지 (Phase 2 예정)                                   │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│   사용자 방문 (koreanewskorea.com)                                         │
│        ↓                                                                    │
│   [IP 추출] → [MaxMind GeoLite2 조회]                                      │
│        ↓                                                                    │
│   위치: 광주광역시                                                          │
│        ↓                                                                    │
│   팝업: "광주 지역 뉴스로 이동하시겠습니까?"                               │
│        ↓                                                                    │
│   [확인] → /gwangju/ 로 리다이렉트                                         │
│   [취소] → / (중앙뉴스) 유지                                               │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

## 📁 프로젝트 폴더 구조 (2025-12-30)

```
koreanews/
├── src/                          # 1번작업: koreanewsone.com 🛡️ PROTECTED
│
├── koreanewskorea/               # 2번작업: 통합 플랫폼 (jeonnam + HQ 병합)
│   ├── src/app/
│   │   ├── page.tsx              # / 중앙뉴스
│   │   ├── policy/               # /policy/ 정책
│   │   ├── tour/                 # /tour/ 관광
│   │   ├── [region]/             # /gwangju/, /mokpo/ 등
│   │   ├── admin/                # 관리자
│   │   └── api/                  # API
│   └── package.json              # port 3002
│
├── jeonnam/                      # DEPRECATED → koreanewskorea로 통합됨
├── koreanewshq/                  # DEPRECATED → koreanewskorea로 통합됨
│
└── scrapers/                     # 4번작업: 데이터 수집
```

## ✅ 통합 작업 완료 내역 (2025-12-30)

| # | 작업 | 상태 | 비고 |
|:-:|------|:----:|------|
| 1 | jeonnam/ → koreanewskorea/ 복사 | ✅ | 완료 |
| 2 | koreanewshq/의 policy, tour 페이지 병합 | ✅ | 완료 |
| 3 | HQ 스타일 병합 (globals.css) | ✅ | 완료 |
| 4 | package.json 업데이트 | ✅ | name: koreanewskorea |
| 5 | 계획서 업데이트 | ✅ | 이 문서 |
| 6 | CLAUDE.md 업데이트 | ⏳ | 진행 중 |

---

---

## 작업 개요

Korea NEWS 홈페이지를 미러링하여 새로운 홈페이지를 만드는 대규모 프로젝트.
복잡한 작업이므로 기획부터 체계적으로 진행.

---

# 2025-12-28 (토)

## 1. 대화 요약

### 1.1 사용자 요청
- 홈페이지 미러링 및 복제 작업 시작
- 여러 가지 변경이 필요한 복잡한 작업
- 기획이 중요하므로 먼저 전체 구조 파악 필요
- Admin부터 아키텍처까지 상세히 점검 요청

### 1.2 진행 상황
- [x] 전체 프로젝트 구조 분석 완료
- [x] Admin 시스템 아키텍처 분석 완료
- [x] 데이터베이스 레이어 분석 완료
- [x] API 아키텍처 분석 완료
- [x] 프론트엔드 페이지 구조 분석 완료
- [x] 스크래퍼 시스템 분석 완료
- [x] 작업 기록 파일 생성

---

## 2. 아키텍처 분석 결과

### 2.1 프로젝트 규모

| 항목 | 수치 |
|------|------|
| 총 페이지 | 140+ 페이지 |
| API 엔드포인트 | 89개 |
| 데이터베이스 테이블 | 30+ 테이블 |
| 컴포넌트 | 31+ 공용 컴포넌트 |
| 스크래퍼 | 26개 지역 |
| Admin 페이지 | 45+ 페이지 |

### 2.2 디렉토리 구조

```
koreanews/
├── src/                    # 메인 Next.js 앱 (koreanewsone)
│   ├── app/                # 140+ 라우트
│   │   ├── (site)/         # 공개 페이지 (30페이지)
│   │   ├── admin/          # 관리자 (45+페이지)
│   │   ├── reporter/       # 기자 포털 (11페이지)
│   │   ├── blog/           # 블로그 (5페이지)
│   │   ├── cosmos/         # CosmicPulse (2페이지)
│   │   └── api/            # API (89개)
│   ├── components/         # 공용 컴포넌트 (31+)
│   ├── lib/                # 유틸리티 (25+모듈)
│   └── db/                 # SQL 스키마 (16파일)
├── scrapers/               # Python 스크래퍼 (26지역)
├── koreanewshq/            # HQ 홈페이지 (별도 인프라) - NEW
└── koreanewskorea/         # 지역 서브도메인 (일시중지)
```

### 2.3 Admin 시스템 (45+ 페이지)

**메뉴 구조 (8개 그룹):**

| 그룹 | 페이지들 |
|------|----------|
| 대시보드 | 메인 대시보드, 통계 |
| 콘텐츠 | 기사관리, AI뉴스, 초안 |
| 수집시스템 | 스크래퍼 실행/스케줄/로그/소스 |
| AI도구 | Claude Hub, AI Ideas |
| 사용자 | 기자관리, 회원관리, 역할 |
| 설정 | AI, 일반, 카테고리, 메뉴, 레이아웃 |
| 모니터링 | 성능, 사용량, Git상태 |
| 단축키 | 기자페이지, Claude 사용량 |

### 2.4 데이터베이스 (30+ 테이블)

**핵심 테이블:**

| 도메인 | 테이블 |
|--------|--------|
| 뉴스 | posts, categories, reporters, news_sources |
| 블로그 | blog_posts, blog_categories, blog_sources (6개) |
| AI | ai_usage_logs, verification_logs |
| 모니터링 | bot_logs, job_sessions, job_logs |
| Claude Hub | project_registry, knowledge_hub, session_logs |
| 개인화 | personalization_settings, region_weights |

**Supabase 클라이언트 패턴 (3종):**
1. `supabaseAdmin` (Service Role) - 서버 전용
2. `supabaseServer` (SSR) - 서버 컴포넌트
3. `supabaseBrowser` (Anon) - 클라이언트

### 2.5 API 아키텍처 (89개)

| 카테고리 | 엔드포인트 수 | 주요 기능 |
|----------|--------------|-----------|
| Bot/Scraper | 25+ | 실행, 로그, 소스관리 |
| Posts | 9 | 기사 CRUD, 통계 |
| Claude Hub | 10 | 프로젝트, 지식베이스 |
| Reporter | 10 | 기자 포털 |
| Admin | 11 | 관리자 전용 |
| Categories | 4 | 카테고리 관리 |
| Blog | 5 | 블로그 시스템 |
| 기타 | 25+ | 인증, 업로드, 설정 등 |

### 2.6 프론트엔드 구조

**레이아웃 계층:**
```
RootLayout
  └─ SiteLayout
      ├─ Header (4개 레이어)
      │   ├─ 유틸리티 바 (소셜, 날짜)
      │   ├─ 로고 존 (브랜딩)
      │   ├─ GNB (메뉴, 검색)
      │   └─ 뉴스 티커
      ├─ Main Content
      └─ Footer
```

**디자인 시스템:**
- 본문 폰트: Pretendard (고딕)
- 제목 폰트: ChosunilboMyungjo (명조)
- 메인 컬러: #A6121D (코리아 레드)
- 보조 컬러: #0a192f (딥 네이비)

### 2.7 스크래퍼 시스템 (26개 지역)

**지역 분류:**

| 타입 | 수 | 지역들 |
|------|-----|--------|
| 광역시/도 | 2 | 광주, 전남 |
| 시 | 5 | 목포, 여수, 순천, 나주, 광양 |
| 군 | 17 | 담양, 곡성, 구례... |
| 교육청 | 2 | 광주교육청, 전남교육청 |

**데이터 파이프라인:**
```
[Light Monitor] HTTP 폴링
       ↓
[Python Scraper] Playwright 크롤링
       ↓
[/api/bot/ingest] API 수집
       ↓
[Supabase] DB 저장
       ↓
[Homepage] 웹 표시
```

### 2.8 인프라 (3개 프로젝트)

| 프로젝트 | 도메인 | Vercel | Supabase | 상태 |
|----------|--------|--------|----------|------|
| Main (src/) | koreanewsone.com | koreanews-projects | 공유 | 운영중 |
| HQ (koreanewshq/) | koreanewskorea.com | koreanewskoreas-projects | 별도 | 개발중 |
| Regional | {region}.koreanewskorea.com | HQ와 공유 | HQ와 공유 | 일시중지 |

---

## 3. 미러링 작업을 위한 핵심 포인트

### 3.1 복제해야 할 것들

1. **코드베이스**: src/ 전체 (Next.js 앱)
2. **데이터베이스**: 30+ 테이블 스키마
3. **환경변수**: Supabase, AI API 키들
4. **스타일**: globals.css, Tailwind 테마
5. **컴포넌트**: 31+ 공용 컴포넌트

### 3.2 변경해야 할 것들

1. **브랜딩**: 로고, 사이트명, 색상
2. **도메인**: URL, 메타데이터
3. **Supabase**: 새 프로젝트 연결
4. **Vercel**: 새 배포 설정
5. **스크래퍼**: 대상 지역/사이트

### 3.3 주의사항

- HQ는 이미 별도 인프라 (koreanewshq/)
- 스크래퍼 연동 필요시 별도 설정
- AI 키 공유 vs 분리 결정 필요

---

## 4. 실제 작업 내역

### 4.1 파일 생성/수정

| 시간 | 파일 | 작업 | 설명 |
|------|------|------|------|
| 09:XX | 로컬홈페이지작업.md | 생성 | 작업 기록 파일 생성 |

### 4.2 명령어 실행

```
(아직 없음 - 분석 단계)
```

### 4.3 에러 및 해결

```
(아직 없음)
```

---

## 5. 핵심 결정 사항

### 5.1 프로젝트 비전 (확정)

```
┌─────────────────────────────────────────────────────────────┐
│  코리아NEWS 멀티사이트 구조                                  │
│                                                              │
│  [코리아NEWS] ─ koreanewsone.com (본사/메인)                │
│       │                                                      │
│       ├─── [코리아NEWS 광주] gwangju.koreanewsone.com       │
│       ├─── [코리아NEWS 나주] naju.koreanewsone.com          │
│       ├─── [코리아NEWS 전남] jeonnam.koreanewsone.com       │
│       ├─── [코리아NEWS 순천] suncheon.koreanewsone.com      │
│       ├─── [코리아NEWS 목포] mokpo.koreanewsone.com         │
│       └─── ... (총 26개 지역 사이트)                        │
│                                                              │
│  각 지역 사이트 구성:                                        │
│       - 정치, 경제, 환경, 지역소식, 오피니언 등              │
│       - 해당 지역 뉴스만 필터링하여 표시                     │
│       - 공통 Admin에서 통합 관리                             │
└─────────────────────────────────────────────────────────────┘
```

### 5.2 Admin 통합 관리 (확정)

```
┌─────────────────────────────────────────────────────────────┐
│  하나의 Admin에서 모든 사이트를 통합 관리                    │
│                                                              │
│  [Admin] koreanewsone.com/admin                             │
│     │                                                        │
│     ├─── 기사 관리 (26개 지역 + 본사)                       │
│     ├─── 스크래퍼 관리 (26개 지역)                          │
│     ├─── 사용자/기자 관리                                   │
│     ├─── 설정 (사이트별 설정 포함)                          │
│     └─── AI 도구                                            │
│                                                              │
│  장점:                                                       │
│     - 중앙 집중 관리                                         │
│     - 코드 중복 최소화                                       │
│     - 일관된 운영 경험                                       │
└─────────────────────────────────────────────────────────────┘
```

### 5.3 첫 번째 시도: 광주 지역 사이트 (파일럿)

```
┌─────────────────────────────────────────────────────────────┐
│  1단계 목표: gwangju.koreanewsone.com                       │
│                                                              │
│  작업 내용:                                                  │
│     1. 현재 koreanewsone.com 코드 복사                      │
│     2. 광주 지역용으로 커스터마이징                         │
│        - 브랜딩: "코리아NEWS 광주"                          │
│        - 필터링: 광주 지역 기사만 표시                      │
│        - 카테고리: 정치, 경제, 환경, 지역소식, 오피니언     │
│     3. 서브도메인 설정 (gwangju.koreanewsone.com)           │
│     4. 테스트 및 검증                                       │
│                                                              │
│  성공 후:                                                    │
│     - 나머지 25개 지역 사이트 순차적 생성                   │
│     - 템플릿화하여 빠른 복제 가능하도록                     │
└─────────────────────────────────────────────────────────────┘
```

### 5.4 기사 관리 방식 (확정)

```
┌─────────────────────────────────────────────────────────────┐
│  현재 (Phase 1): 통합 방식                                   │
│                                                              │
│     - 기존 일괄 스크래핑 유지                               │
│     - 모든 기사가 하나의 posts 테이블에 저장                │
│     - 각 지역 사이트는 region 필드로 필터링                 │
│     - Admin에서 통합 관리                                   │
│                                                              │
│  미래 (Phase 2): 마이그레이션                               │
│                                                              │
│     - 데이터 분리 검토                                      │
│     - 필요시 site_id 추가                                   │
│     - 성능 최적화                                           │
└─────────────────────────────────────────────────────────────┘
```

### 5.5 보류 사항 (중요!)

```
┌─────────────────────────────────────────────────────────────┐
│  ⚠️ koreanewskorea.com (HQ) - 보류                          │
│                                                              │
│  상태: 개발 일시 중단                                        │
│  이유: 지역 사이트 우선 진행                                │
│  조치: 나중에 별도 결정 예정                                │
│                                                              │
│  현재 인프라:                                                │
│     - Supabase: aubjcabybfuhyrcaniyf (별도)                 │
│     - Vercel: koreanewskoreas-projects                      │
│     - 폴더: koreanewshq/                                    │
│                                                              │
│  ❗ 이 프로젝트는 현재 작업과 별개로 유지                    │
│  ❗ 나중에 다시 검토할 때까지 건드리지 않음                  │
└─────────────────────────────────────────────────────────────┘
```

### 5.6 확정된 답변 정리

| 질문 | 답변 |
|------|------|
| **홈페이지 개수** | 본사(1) + 지역(26) = 총 27개 예정 |
| **첫 시도** | gwangju.koreanewsone.com (광주) |
| **콘텐츠 구분** | 지역별 (각 지역 내 정치/경제/환경 등) |
| **기사 공유** | 현재 통합, 추후 마이그레이션으로 분리 |
| **Admin** | 하나로 통합 관리 |
| **koreanewskorea.com** | 보류 (나중에 조치) |

### 5.7 서브도메인 구현 방식 (확정)

```
┌─────────────────────────────────────────────────────────────┐
│  Middleware 라우팅 방식 채택 (무료!)                        │
│                                                              │
│  방식 비교:                                                  │
│     A) Vercel Pro ($20/월) - 간단하지만 유료               │
│     B) 별도 프로젝트 - 무료지만 27개 관리 복잡             │
│     C) Middleware 라우팅 - 무료 + 하나의 코드베이스 ✅      │
│     D) Cloudflare 프록시 - 무료지만 설정 복잡              │
│                                                              │
│  선택: C) Middleware 라우팅                                  │
│                                                              │
│  동작 원리:                                                  │
│     요청: gwangju.koreanewsone.com                          │
│        ↓                                                     │
│     [Middleware] 호스트 감지 → region = "gwangju"           │
│        ↓                                                     │
│     [페이지] 광주 지역 기사만 필터링해서 표시               │
│                                                              │
│  장점:                                                       │
│     - 추가 비용 없음 (무료)                                 │
│     - 코드베이스 하나로 27개 사이트 운영                    │
│     - 배포도 한 번만                                        │
│     - 유지보수 쉬움                                         │
└─────────────────────────────────────────────────────────────┘
```

### 5.8 개발 접근 방식 (확정)

```
┌─────────────────────────────────────────────────────────────┐
│  Option B: 바로 구현 시작                                    │
│                                                              │
│  이유:                                                       │
│     - 먼저 복사해서 확인 후 구조 재설계                     │
│     - 완벽하게 만든 후 다른 홈페이지에 적용                 │
│     - 실제로 만들어보면서 문제점 파악                       │
│                                                              │
│  작업 순서:                                                  │
│     1. src/ → gwangju/ 폴더 복사                            │
│     2. 필요한 부분만 수정 (브랜딩, 필터링 등)               │
│     3. 로컬에서 테스트 (완성될 때까지)                      │
│     4. 완성 후 Middleware 방식으로 src/에 통합              │
│     5. DNS 서브도메인 추가 + Vercel 배포                    │
└─────────────────────────────────────────────────────────────┘
```

---

## 6. 작업 진행 상황

### 6.1 1단계: 광주 사이트 파일럿

| 순서 | 작업 | 상태 | 비고 |
|:----:|------|:----:|------|
| 1 | src/ → gwangju/ 폴더 복사 | ✅ 완료 | 2025-12-28 |
| 2 | package.json 수정 (이름, 포트 등) | ✅ 완료 | port 3001 |
| 3 | 브랜딩 수정 (사이트명, 로고) | ✅ 완료 | "코리아NEWS 광주" |
| 4 | AdminSidebar.tsx 구조 수정 | ✅ 완료 | 광주 Admin 전용 |
| 5 | Hero Slider API 수정 | ✅ 완료 | hero_slider_gwangju 키 |
| 6 | Hero Slider 설정 페이지 | ✅ 완료 | 광주 전용 설정 |
| 7 | 기사 필터링 (광주 지역만) | ✅ 완료 | page.tsx, Sidebar.tsx |
| 8 | GNB 메뉴 정리 | ✅ 완료 | CosmicPulse 제거 |
| 9 | 카테고리 구성 | ⏳ 대기 | |
| 10 | 로컬 테스트 | 🔄 진행중 | localhost:3001 |
| 11 | 버그 수정 및 완성 | ⏳ 대기 | |
| 12 | src/에 Middleware 통합 | ⏳ 대기 | |
| 13 | DNS + Vercel 배포 | ⏳ 대기 | |

### 6.2 파일 작업 내역

| 시간 | 파일/폴더 | 작업 | 설명 |
|------|-----------|------|------|
| 09:XX | 로컬홈페이지작업.md | 생성 | 작업 기록 파일 |
| 09:XX | 로컬홈페이지작업.md | 수정 | 결정사항 추가 |
| - | gwangju/ | 복사 예정 | src/ 복사 |

---

---

## 7. v2 계획: 메뉴 타입 시스템

### 7.1 메뉴 타입 3종 (Type A/B/C)

```
┌─────────────────────────────────────────────────────────────┐
│  Type A: 광역시/도 (8개 메뉴)                               │
│                                                              │
│  적용: 광주광역시, 전라남도                                  │
│                                                              │
│  메뉴:                                                       │
│     1. 정치 (Politics)                                       │
│     2. 경제 (Economy)                                        │
│     3. 사회 (Society)                                        │
│     4. 환경 (Environment)                                    │
│     5. 의회 (Council) ★ 광역만 있음                         │
│     6. 지역소식 (Local News)                                 │
│     7. 문화/교육 (Culture/Education)                        │
│     8. 오피니언 (Opinion)                                    │
└─────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────┐
│  Type B: 시 (8개 메뉴)                                       │
│                                                              │
│  적용: 목포시, 여수시, 순천시, 나주시, 광양시               │
│                                                              │
│  메뉴:                                                       │
│     1. 정치 (Politics)                                       │
│     2. 경제 (Economy)                                        │
│     3. 사회 (Society)                                        │
│     4. 환경 (Environment)                                    │
│     5. 지역소식 (Local News)                                 │
│     6. 문화 (Culture)                                        │
│     7. 교육 (Education)                                      │
│     8. 오피니언 (Opinion)                                    │
└─────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────┐
│  Type C: 군 (7개 메뉴)                                       │
│                                                              │
│  적용: 담양군, 곡성군, 구례군, 고흥군, 보성군 등 17개 군    │
│                                                              │
│  메뉴:                                                       │
│     1. 정치 (Politics)                                       │
│     2. 경제 (Economy)                                        │
│     3. 사회 (Society)                                        │
│     4. 환경 (Environment)                                    │
│     5. 지역소식 (Local News)                                 │
│     6. 문화/교육 (Culture/Education)                        │
│     7. 오피니언 (Opinion)                                    │
│                                                              │
│  ★ 의회 메뉴 없음 (군 의회는 보도량 적음)                   │
└─────────────────────────────────────────────────────────────┘
```

### 7.2 지역별 타입 배정

| 타입 | 지역 (수) | 상세 |
|------|----------|------|
| **Type A** | 광역시/도 (2) | 광주광역시, 전라남도 |
| **Type B** | 시 (5) | 목포, 여수, 순천, 나주, 광양 |
| **Type C** | 군 (17) | 담양, 곡성, 구례, 고흥, 보성, 화순, 장흥, 강진, 해남, 영암, 무안, 함평, 영광, 장성, 완도, 진도, 신안 |
| **교육청** | 특수 (2) | 광주교육청, 전남교육청 (별도 메뉴) |

---

## 8. v2 계획: IP 지오로케이션 시스템

### 8.1 개요

```
┌─────────────────────────────────────────────────────────────┐
│  MaxMind GeoLite2를 활용한 자동 지역 감지                    │
│                                                              │
│  동작 원리:                                                  │
│     1. 사용자 첫 방문 → IP 주소 추출                        │
│     2. GeoLite2-City.mmdb로 위치 조회                       │
│     3. 가장 가까운 지역 사이트로 안내                       │
│     4. 쿠키/localStorage에 선호 지역 저장                   │
│                                                              │
│  예시:                                                       │
│     광주 IP → "광주 지역 사이트로 이동하시겠습니까?"        │
│     전남 IP → 해당 시/군 사이트로 안내                      │
└─────────────────────────────────────────────────────────────┘
```

### 8.2 기술 스택

| 구성요소 | 기술 | 비고 |
|----------|------|------|
| IP 데이터베이스 | MaxMind GeoLite2-City.mmdb | 무료, 월 1회 업데이트 |
| 조회 라이브러리 | maxmind (Node.js) | npm install maxmind |
| 위치 매핑 | 위경도 → 지역명 | 커스텀 매핑 테이블 |

### 8.3 지역 매핑 테이블 (예시)

```javascript
const REGION_MAPPING = {
  // 광주광역시 (5개 구)
  "gwangju": { lat: 35.1595, lng: 126.8526, type: "A", name: "광주" },

  // 전라남도 시
  "mokpo": { lat: 34.8118, lng: 126.3922, type: "B", name: "목포" },
  "yeosu": { lat: 34.7604, lng: 127.6622, type: "B", name: "여수" },
  "suncheon": { lat: 34.9506, lng: 127.4875, type: "B", name: "순천" },
  "naju": { lat: 35.0159, lng: 126.7108, type: "B", name: "나주" },
  "gwangyang": { lat: 34.9407, lng: 127.6959, type: "B", name: "광양" },

  // 전라남도 군
  "damyang": { lat: 35.3212, lng: 126.9882, type: "C", name: "담양" },
  // ... (17개 군)
};
```

### 8.4 구현 우선순위

```
Phase 1 (현재): 수동 지역 선택
  - 본사 메인페이지에서 지역 선택 UI 제공
  - 선택한 지역 쿠키에 저장

Phase 2 (추후): IP 자동 감지
  - MaxMind 라이브러리 도입
  - 첫 방문시 팝업으로 지역 확인
  - 거부시 본사 유지

Phase 3 (미래): 정교화
  - 읍/면/동 레벨 매핑
  - 방문 패턴 기반 추천
```

---

## 9. v2 계획: DB 스키마 확장

### 9.1 posts 테이블 확장

```sql
-- 기존 컬럼 유지 + 신규 컬럼 추가
ALTER TABLE posts ADD COLUMN IF NOT EXISTS geo_lat DECIMAL(10, 8);
ALTER TABLE posts ADD COLUMN IF NOT EXISTS geo_lng DECIMAL(11, 8);
ALTER TABLE posts ADD COLUMN IF NOT EXISTS region_type VARCHAR(10); -- 'metro', 'city', 'county'
```

### 9.2 regions 테이블 (신규)

```sql
CREATE TABLE IF NOT EXISTS regions (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  slug VARCHAR(50) UNIQUE NOT NULL,      -- 'gwangju', 'mokpo' 등
  name_ko VARCHAR(50) NOT NULL,          -- '광주광역시', '목포시'
  name_en VARCHAR(50),                   -- 'Gwangju', 'Mokpo'
  type VARCHAR(10) NOT NULL,             -- 'A', 'B', 'C'
  geo_lat DECIMAL(10, 8),
  geo_lng DECIMAL(11, 8),
  parent_region UUID REFERENCES regions(id), -- 상위 지역 (군 → 도)
  menu_config JSONB,                     -- 메뉴 설정 오버라이드
  created_at TIMESTAMPTZ DEFAULT now(),
  updated_at TIMESTAMPTZ DEFAULT now()
);

-- 초기 데이터
INSERT INTO regions (slug, name_ko, type) VALUES
  ('gwangju', '광주광역시', 'A'),
  ('jeonnam', '전라남도', 'A'),
  ('mokpo', '목포시', 'B'),
  ('yeosu', '여수시', 'B'),
  ('suncheon', '순천시', 'B'),
  ('naju', '나주시', 'B'),
  ('gwangyang', '광양시', 'B'),
  ('damyang', '담양군', 'C'),
  -- ... (나머지 군)
;
```

### 9.3 site_settings 확장 (지역별 설정)

```sql
-- 기존 site_settings 활용
-- key 네이밍: {feature}_{region}
-- 예: hero_slider_gwangju, menu_config_mokpo

INSERT INTO site_settings (key, value, description) VALUES
  ('hero_slider_gwangju', '{"regions":["gwangju"],"interval":4000}', '광주 히어로'),
  ('hero_slider_mokpo', '{"regions":["mokpo"],"interval":4000}', '목포 히어로'),
  -- ...
;
```

---

## 10. v2 계획: 개발 타임라인

### 10.1 12시간 단계별 계획

```
┌─────────────────────────────────────────────────────────────┐
│  Phase 1: 기반 구축 (4시간) ✅ 완료                         │
│                                                              │
│  ✅ Hour 1-2: 광주 파일럿 폴더 생성                         │
│     - src/ → gwangju/ 복사                                  │
│     - package.json 수정 (port 3001)                         │
│     - 브랜딩 수정 (코리아NEWS 광주)                         │
│                                                              │
│  ✅ Hour 3-4: 핵심 컴포넌트 수정                            │
│     - AdminSidebar.tsx (광주 전용)                          │
│     - Hero Slider API (hero_slider_gwangju)                 │
│     - 기사 필터링 (page.tsx, Sidebar.tsx)                   │
│     - GNB 정리 (CosmicPulse 제거)                           │
└─────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────┐
│  Phase 2: 기능 완성 (4시간) - 진행 예정                     │
│                                                              │
│  Hour 5-6: 카테고리 시스템                                  │
│     - 광주용 카테고리 API 수정                              │
│     - Type A 메뉴 구성 (의회 포함 8개)                      │
│     - GNB 카테고리 연동                                     │
│                                                              │
│  Hour 7-8: 상세 페이지 수정                                 │
│     - 기사 상세 페이지 광주 필터                            │
│     - 카테고리별 목록 페이지                                │
│     - 검색 기능 지역 필터                                   │
└─────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────┐
│  Phase 3: 통합 및 배포 (4시간) - 대기                       │
│                                                              │
│  Hour 9-10: Middleware 통합                                 │
│     - src/middleware.ts 작성                                │
│     - 서브도메인 감지 로직                                  │
│     - 지역별 라우팅 처리                                    │
│                                                              │
│  Hour 11-12: 배포 및 테스트                                 │
│     - DNS 서브도메인 추가                                   │
│     - Vercel 배포                                           │
│     - E2E 테스트                                            │
└─────────────────────────────────────────────────────────────┘
```

### 10.2 향후 확장 계획

```
Week 2: 나머지 시 지역 (5개)
  - 목포, 여수, 순천, 나주, 광양
  - Type B 템플릿 적용

Week 3-4: 군 지역 (17개)
  - 담양부터 신안까지 순차 생성
  - Type C 템플릿 적용

Week 5: IP 지오로케이션
  - MaxMind 도입
  - 자동 지역 감지 기능

Week 6: 최적화
  - 성능 튜닝
  - SEO 최적화
  - 모니터링 구축
```

---

## 11. 참고 문서

- [CLAUDE.md](./CLAUDE.md) - 프로젝트 메인 가이드
- [info/frontend.md](./info/frontend.md) - 프론트엔드 개발 가이드
- [info/backend.md](./info/backend.md) - 백엔드 개발 가이드
- [info/database.md](./info/database.md) - 데이터베이스 스키마
- [scrapers/SCRAPER_GUIDE.md](./scrapers/SCRAPER_GUIDE.md) - 스크래퍼 개발 가이드

---

## 변경 이력

| 날짜 | 버전 | 변경 내용 | 작성자 |
|------|------|----------|--------|
| 2025-12-28 | 0.1 | 초기 문서 생성, 아키텍처 분석 결과 기록 | Claude |
| 2025-12-28 | 0.2 | v2 계획 추가 (메뉴 타입, IP 지오로케이션, DB 스키마, 타임라인) | Claude |
| 2025-12-28 | 0.2 | 진행 상황 업데이트 (Phase 1 완료) | Claude |

---

*이 문서는 작업 진행에 따라 계속 업데이트됩니다.*
