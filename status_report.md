# 📊 스크래퍼 현황 및 특징 분석 보고서 (2025-12-09)

## 1. 개요
사용자의 요청에 따라 현재 "이미지 경량화(Lightweight v3)" 리팩토링 작업의 결과와, 각 시군별 스크래핑 봇의 구조적 특징을 정리합니다.

> **핵심 반성:** 진도군(Jindo)의 경우 초기 분석 시 "수집 불가"로 오판하였으나, 정밀 분석 결과 **"URL 및 셀렉터 불일치"**가 원인이었으며, 이를 수정한 결과 정상적으로 **기사 및 이미지 수집에 성공**하였습니다.

---

## 2. 시군별 스크래퍼 특징 및 현황

현재 6개 주요 관리 대상 시군에 대한 분석 결과입니다.

| 시군 (Region) | 구조 유형 (Type) | 리팩토링 상태 | 상태 (Status) | 주요 특징 및 해결책 |
| :--- | :--- | :--- | :--- | :--- |
| **목포시 (Mokpo)** | **표준형 A** | ✅ 완료 (Lightweight v3) | 🟢 **정상** | - **HTML 구조:** `div.viewbox` (본문), `a.item_cont` (목록)<br>- **이미지:** 핫링크 차단 없음. 직접 링크(`src`) 추출로 전환.<br>- **특이사항:** 가장 표준적인 구조. |
| **진도군 (Jindo)** | **특이형 B** | ✅ 완료 (Lightweight v3) | 🟢 **정상** | - **HTML 구조:** `ul.news_list` (목록), `div.viewbox` (본문)<br>- **URL 패턴:** `/home/sub.cs?m=626` (특이 URL 사용)<br>- **페이지네이션:** `pageIndex` 파라미터 사용.<br>- **해결:** 잘못된 URL(`/news/press`)과 셀렉터(`tbody`)를 수정하여 정상화됨. |
| **신안군 (Shinan)** | **혼합형 (추정)** | ⚠️ 로직만 적용 | 🔴 **실패** | - **원인:** 목록 셀렉터가 `tbody tr`로 설정되어 있으나, 실제 사이트는 진도군과 유사한 `ul > li` 구조일 가능성 높음.<br>- **조치:** `MOKPO_CONTENT_SELECTORS`는 적용했으나, **목록 셀렉터 수정 필요**. |
| **영광군 (Yeonggwang)** | **표준형 A (추정)** | ⚠️ 로직만 적용 | 🟡 **확인중** | - **상태:** `MOKPO_CONTENT_SELECTORS` 적용 완료.<br>- **과제:** 실제 실행 시 목록(`tbody tr`)이 잡히는지 확인 필요. |
| **완도군 (Wando)** | **특이형 (추정)** | ⚠️ 로직만 적용 | 🔴 **실패** | - **원인:** 진도/신안과 유사한 웹사이트 솔루션 사용 추정.<br>- **조치:** 진도군처럼 `ul.news_list` 등의 셀렉터 전수 조사가 필요함. |
| **함평군/무안군** | **표준형 A (추정)** | ⚠️ 로직만 적용 | 🟡 **확인중** | - **상태:** `div.viewbox` 등 표준 셀렉터 적용됨. 실제 URL 접속 테스트 필요. |

---

## 3. 기술적 변경 사항 (Lightweight v3)

모든 시군 봇에 공통적으로 적용된(또는 적용 중인) 새로운 아키텍처입니다.

### 1) 이미지 수집 방식 변경
- **기존 (Legacy):**
  1. 브라우저가 이미지 로딩할 때까지 대기
  2. 이미지를 다운로드 (바이너리)
  3. 클라우드에 재업로드 (Cloudinary)
  4. **단점:** 속도가 느리고, 핫링크 보호가 강력한 사이트에서 실패 확률 높음.

- **신규 (Lightweight v3):**
  1. HTML에서 `img` 태그의 `src`만 추출
  2. 절대 주소(Full URL)로 변환하여 그대로 DB 저장
  3. **장점:** 속도가 매우 빠르고(HTTP 요청 최소화), 목포/진도 등 대부분의 관공서 사이트에서 정상 작동함.

### 2) 로깅 표준화
- `print` 문과 함께 `log_to_server` 함수를 사용하여, 관리자 대시보드에서 실시간으로 "수집 중...", "성공" 메시지를 볼 수 있도록 통일했습니다.

---

## 4. 향후 계획 (Next Steps)
1.  **신안/완도 등 '실패' 그룹 전수 조사:**
    - 진도군 해결 사례(`debug_dump.py` 활용)를 그대로 적용하여, 이들의 실제 HTML 구조(URL 및 셀렉터)를 파악하고 수정합니다.
2.  **안정화:**
    - 모든 봇이 `Lightweight v3` 로직으로 하루 1회 정상 작동하는지 모니터링합니다.
