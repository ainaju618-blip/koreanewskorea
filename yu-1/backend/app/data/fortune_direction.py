"""
ìš´ì„¸ ë°©í–¥ë³„ í•´ì„ ì‹œìŠ¤í…œ

ì£¼ì—­ = í•˜ëŠ˜ì˜ ëœ»ì„ ì½ëŠ” ê²ƒ
- ê¸¸(å‰)í•œ ìš´ â†’ ì ê·¹ì ìœ¼ë¡œ ë‚˜ì•„ê°€ë¼
- í‰(å‡¶)í•œ ìš´ â†’ ì†Œê·¹ì ìœ¼ë¡œ ê¸°ë‹¤ë¦¬ë¼

í•µì‹¬: ê´˜ì‚¬/íš¨ì‚¬ë¥¼ í˜„ëŒ€ì ìœ¼ë¡œ í’€ì–´ì„œ í•˜ëŠ˜ì˜ ëœ» ì „ë‹¬
"""
from typing import Dict, List, Tuple
from enum import Enum
from dataclasses import dataclass


class FortuneLevel(Enum):
    """ìš´ì„¸ ë“±ê¸‰"""
    GREAT_FORTUNE = "ëŒ€ê¸¸"      # å¤§å‰ 90-100ì 
    FORTUNE = "ê¸¸"              # å‰ 75-89ì 
    SMALL_FORTUNE = "ì†Œê¸¸"      # å°å‰ 60-74ì 
    NEUTRAL = "í‰"              # å¹³ 45-59ì 
    SMALL_MISFORTUNE = "ì†Œí‰"   # å°å‡¶ 30-44ì 
    MISFORTUNE = "í‰"           # å‡¶ 15-29ì 
    GREAT_MISFORTUNE = "ëŒ€í‰"   # å¤§å‡¶ 0-14ì 


class ActionDirection(Enum):
    """í–‰ë™ ë°©í–¥"""
    AGGRESSIVE = "ì ê·¹"     # ëŒ€ê¸¸, ê¸¸ â†’ ì ê·¹ì ìœ¼ë¡œ ë‚˜ì•„ê°€ë¼
    MODERATE = "ì¤‘ë„"       # ì†Œê¸¸, í‰ â†’ ì¡°ì‹¬ìŠ¤ëŸ½ê²Œ, ì‘ê²Œ ì‹œì‘
    PASSIVE = "ì†Œê·¹"        # ì†Œí‰, í‰ â†’ ê¸°ë‹¤ë¦¬ë¼, ë©ˆì¶°ë¼
    RETREAT = "í›„í‡´"        # ëŒ€í‰ â†’ ë¬¼ëŸ¬ë‚˜ë¼, í¬ê¸°ë„ ê³ ë ¤


# ============================================================================
# ìš´ì„¸ ë“±ê¸‰ â†’ í–‰ë™ ë°©í–¥ ë§¤í•‘
# ============================================================================

FORTUNE_TO_ACTION: Dict[FortuneLevel, ActionDirection] = {
    FortuneLevel.GREAT_FORTUNE: ActionDirection.AGGRESSIVE,
    FortuneLevel.FORTUNE: ActionDirection.AGGRESSIVE,
    FortuneLevel.SMALL_FORTUNE: ActionDirection.MODERATE,
    FortuneLevel.NEUTRAL: ActionDirection.MODERATE,
    FortuneLevel.SMALL_MISFORTUNE: ActionDirection.PASSIVE,
    FortuneLevel.MISFORTUNE: ActionDirection.PASSIVE,
    FortuneLevel.GREAT_MISFORTUNE: ActionDirection.RETREAT,
}


# ============================================================================
# í–‰ë™ ë°©í–¥ë³„ í•´ì„ í…œí”Œë¦¿ (ì ìˆ ê°€ í†¤)
# ============================================================================

ACTION_TEMPLATES: Dict[ActionDirection, Dict] = {
    # ========== ì ê·¹ (ëŒ€ê¸¸, ê¸¸) ==========
    ActionDirection.AGGRESSIVE: {
        "direction_intro": [
            "í•˜ëŠ˜ì´ ê¸¸ì„ ì—´ì–´ì£¼ëŠ” ë•Œë¡œë‹¤.",
            "ìš´ì˜ íë¦„ì´ ê·¸ëŒ€ í¸ì´ë‹ˆë¼.",
            "ë•Œê°€ ì™”ìœ¼ë‹ˆ, ë§ì„¤ì´ì§€ ë§ë¼.",
        ],
        "action_guide": [
            "ì ê·¹ì ìœ¼ë¡œ ë‚˜ì•„ê°€ë¼. ì§€ê¸ˆì´ ë•Œë‹ˆë¼.",
            "ì£¼ì €í•˜ì§€ ë§ê³  í–‰í•˜ë¼. í•˜ëŠ˜ì´ ë•ëŠë‹ˆë¼.",
            "ëœ»í•œ ë°”ë¥¼ ë°€ê³  ë‚˜ê°€ë¼. ê¸¸ì´ ì—´ë¦¬ë¦¬ë¼.",
            "ê³¼ê°í•˜ê²Œ ì›€ì§ì—¬ë¼. ìš´ì´ ë”°ë¥´ëŠë‹ˆë¼.",
        ],
        "caution": [
            "ë‹¤ë§Œ, êµë§Œí•˜ì§€ëŠ” ë§ë¼. ê²¸ì†ì´ ë³µì„ ì§€í‚¤ëŠë‹ˆë¼.",
            "ë„ˆë¬´ ìš•ì‹¬ë‚´ì§€ëŠ” ë§ë¼. ê³¼ìœ ë¶ˆê¸‰ì´ë‹ˆë¼.",
        ],
        "closing": [
            "í•˜ëŠ˜ì´ ê·¸ëŒ€ì˜ ì•ê¸¸ì„ ì—´ì–´ì£¼ë¦¬ë¼.",
            "ëœ»í•œ ë°” ì´ë£¨ë¦¬ë‹ˆ, ë‚˜ì•„ê°€ë¼.",
            "ë•Œë¥¼ ë†“ì¹˜ì§€ ë§ë¼. í–‰ìš´ì´ í•¨ê»˜í•˜ë¦¬ë¼.",
        ],
        "keywords": ["ë‚˜ì•„ê°€ë¼", "í–‰í•˜ë¼", "ì ê·¹ì ìœ¼ë¡œ", "ë•Œê°€ ì™”ë‹¤", "ê¸°íšŒ"],
    },

    # ========== ì¤‘ë„ (ì†Œê¸¸, í‰) ==========
    ActionDirection.MODERATE: {
        "direction_intro": [
            "ìš´ì´ ë‚˜ì˜ì§€ëŠ” ì•Šìœ¼ë‚˜, ì¡°ì‹¬í•¨ì´ í•„ìš”í•œ ë•Œë¡œë‹¤.",
            "ì‘ì€ ê²ƒë¶€í„° ì‹œì‘í•˜ë©´ ê¸¸ì´ ì—´ë¦¬ë¦¬ë¼.",
            "ê¸‰í•˜ê²Œ ê°€ë©´ ê·¸ë¥´ì¹˜ê³ , ì²œì²œíˆ ê°€ë©´ ì´ë£¨ë¦¬ë¼.",
        ],
        "action_guide": [
            "ì¡°ì‹¬ìŠ¤ëŸ½ê²Œ ë‚˜ì•„ê°€ë¼. ì‘ì€ ë°œê±¸ìŒì´ í° ê¸¸ì„ ë§Œë“œëŠë‹ˆë¼.",
            "í•œ ë²ˆì— ì „ë¶€ê°€ ì•„ë‹Œ, ë‚˜ëˆ„ì–´ í–‰í•˜ë¼.",
            "ë•Œë¥¼ ì‚´í”¼ë©° ì²œì²œíˆ ì›€ì§ì´ë¼.",
            "í¬ê²Œ ë²Œì´ì§€ ë§ê³ , ì‘ê²Œ ì‹œì‘í•˜ë¼.",
        ],
        "caution": [
            "ì„±ê¸‰í•¨ì€ í™”ë¥¼ ë¶€ë¥´ëŠë‹ˆë¼. ì²œì²œíˆ í•˜ë¼.",
            "í° ê²ƒì„ íƒí•˜ë©´ ì‘ì€ ê²ƒë„ ìƒëŠë‹ˆë¼.",
            "ë¬´ë¦¬í•˜ì§€ ë§ë¼. ìˆœë¦¬ë¥¼ ë”°ë¥´ë¼.",
        ],
        "closing": [
            "ì¡°ì‹¬ìŠ¤ëŸ½ê²Œ ë‚˜ì•„ê°€ë©´ ëœ»ì„ ì´ë£¨ë¦¬ë¼.",
            "ì„œë‘ë¥´ì§€ ì•Šìœ¼ë©´ ê¸¸ì´ ì—´ë¦¬ë¦¬ë¼.",
            "ì‘ì€ ì„±ê³µì´ ìŒ“ì—¬ í° ì„±ê³µì´ ë˜ë¦¬ë¼.",
        ],
        "keywords": ["ì¡°ì‹¬ìŠ¤ëŸ½ê²Œ", "ì‘ê²Œ ì‹œì‘", "ì²œì²œíˆ", "ë‚˜ëˆ„ì–´ì„œ", "ë•Œë¥¼ ì‚´í´"],
    },

    # ========== ì†Œê·¹ (ì†Œí‰, í‰) ==========
    ActionDirection.PASSIVE: {
        "direction_intro": [
            "ì§€ê¸ˆì€ ë¬¼ëŸ¬ë‚˜ ë•Œë¥¼ ê¸°ë‹¤ë¦´ ë•Œë¡œë‹¤.",
            "ì„±ê¸‰í•˜ê²Œ ì›€ì§ì´ë©´ í•˜ë˜ ì¼ë„ ê·¸ë¥´ì¹˜ë¦¬ë¼.",
            "í•˜ëŠ˜ì´ ì•„ì§ í—ˆë½í•˜ì§€ ì•Šì•˜ìœ¼ë‹ˆ, ì ì‹œ ë©ˆì¶”ë¼.",
        ],
        "action_guide": [
            "ì ì‹œ ê¸°ë‹¤ë¦¬ë¼. ì•„ì§ ë•Œê°€ ì•„ë‹ˆë‹ˆë¼.",
            "ë¬¼ëŸ¬ë‚˜ í˜•ì„¸ë¥¼ ì‚´í”¼ë¼. ê¸‰í•˜ë©´ ê·¸ë¥´ì¹˜ëŠë‹ˆë¼.",
            "ì›€ì§ì´ì§€ ë§ê³  ì§€í‚¤ë¼. å®ˆê°€ ê³§ í–‰í•¨ì´ë‹ˆë¼.",
            "í•˜ë˜ ê²ƒì„ ìœ ì§€í•˜ë˜, ìƒˆë¡œìš´ ê²ƒì€ ì‚¼ê°€ë¼.",
        ],
        "caution": [
            "ì§€ê¸ˆ ë‚˜ì„œë©´ ì†í•´ë§Œ ì»¤ì§€ë¦¬ë¼.",
            "ì„±ê¸‰í•¨ì´ í™”ë¥¼ ë¶€ë¥´ëŠë‹ˆ, ì°¸ê³  ê¸°ë‹¤ë¦¬ë¼.",
            "ì ë£¡ë¬¼ìš©(æ½›é¾å‹¿ç”¨) - ìš©ì´ ë¬¼ì— ì ê²¼ìœ¼ë‹ˆ ì“°ì§€ ë§ë¼.",
        ],
        "closing": [
            "ê¸°ë‹¤ë¦¼ë„ í–‰í•¨ì´ë‹ˆë¼. ë•Œê°€ ì˜¤ë©´ ì•Œë¦¬ë¼.",
            "ì§€ê¸ˆì˜ í›„í‡´ê°€ í›—ë‚ ì˜ ì „ì§„ì´ ë˜ë¦¬ë¼.",
            "ì¸ë‚´í•˜ë¼. ìš´ì´ ë°”ë€ŒëŠ” ë•Œê°€ ì˜¤ë¦¬ë¼.",
        ],
        "keywords": ["ê¸°ë‹¤ë¦¬ë¼", "ë©ˆì¶”ë¼", "ë¬¼ëŸ¬ë‚˜ë¼", "ë•Œê°€ ì•„ë‹ˆë‹¤", "ì°¸ìœ¼ë¼"],
    },

    # ========== í›„í‡´ (ëŒ€í‰) ==========
    ActionDirection.RETREAT: {
        "direction_intro": [
            "í•˜ëŠ˜ì´ ê²½ê³ í•˜ëŠ” ë•Œë¡œë‹¤. ë¬¼ëŸ¬ë‚¨ì´ ì§€í˜œë‹ˆë¼.",
            "ì§€ê¸ˆì€ ë‚˜ì•„ê°ˆ ë•Œê°€ ì•„ë‹ˆë¼, ì§€í‚¬ ë•Œë‹ˆë¼.",
            "í° í‰ì˜ ê¸°ìš´ì´ ê°ë„ë‹ˆ, ê°ë³„íˆ ì¡°ì‹¬í•˜ë¼.",
        ],
        "action_guide": [
            "ë©ˆì¶”ë¼. ë” ë‚˜ì•„ê°€ë©´ í™”ë¥¼ í‚¤ìš°ëŠë‹ˆë¼.",
            "ì´ë¯¸ ì‹œì‘í–ˆë‹¤ë©´ ì¶•ì†Œí•˜ë¼. ì†ì‹¤ì„ ì¤„ì´ëŠ” ê²ƒì´ ìƒì±…ì´ë‹ˆë¼.",
            "ë¬¼ëŸ¬ë‚˜ í˜ì„ ê¸°ë¥´ë¼. ë•Œê°€ ë°”ë€Œë©´ ë‹¤ì‹œ ë„ëª¨í•˜ë¼.",
            "í¬ê¸°ë„ ìš©ê¸°ë‹ˆë¼. ì˜ëª»ëœ ê¸¸ì„ ê³„ì† ê°€ëŠ” ê²ƒì´ ì–´ë¦¬ì„ìŒì´ë‹ˆë¼.",
        ],
        "caution": [
            "ì§€ê¸ˆ ë¬´ë¦¬í•˜ë©´ í° í™”ë¥¼ ë‹¹í•˜ë¦¬ë¼.",
            "í•­ë£¡ìœ íšŒ(äº¢é¾æœ‰æ‚”) - ë†’ì´ ì˜¤ë¥¸ ìš©ì€ í›„íšŒê°€ ìˆëŠë‹ˆë¼.",
            "ìš•ì‹¬ì´ í™”ë¥¼ ë¶€ë¥´ëŠë‹ˆ, ë‚´ë ¤ë†“ìœ¼ë¼.",
        ],
        "closing": [
            "ë¬¼ëŸ¬ë‚¨ì´ ë¶€ë„ëŸ¬ìš´ ê²ƒì´ ì•„ë‹ˆë‹ˆë¼. ì§€í˜œë¡œë‹¤.",
            "ì˜¤ëŠ˜ì˜ í›„í‡´ê°€ ë‚´ì¼ì˜ ê¸°íšŒë¥¼ ë§Œë“œëŠë‹ˆë¼.",
            "ë•Œë¥¼ ê¸°ë‹¤ë¦¬ë¼. ìš´ì€ ë°˜ë“œì‹œ ë°”ë€ŒëŠë‹ˆë¼.",
        ],
        "keywords": ["ë©ˆì¶”ë¼", "ë¬¼ëŸ¬ë‚˜ë¼", "í¬ê¸°í•˜ë¼", "ì¶•ì†Œí•˜ë¼", "ë‚´ë ¤ë†“ìœ¼ë¼"],
    },
}


# ============================================================================
# ì¹´í…Œê³ ë¦¬ë³„ êµ¬ì²´ì  í–‰ë™ ê°€ì´ë“œ
# ============================================================================

CATEGORY_ACTION_GUIDE: Dict[str, Dict[ActionDirection, List[str]]] = {
    # ğŸ’° ì¬ë¬¼/íˆ¬ì
    "ì¬ë¬¼": {
        ActionDirection.AGGRESSIVE: [
            "íˆ¬ìí•˜ê¸° ì¢‹ì€ ë•Œë‹ˆë¼. ëœ»í•œ ë°”ë¥¼ í–‰í•˜ë¼.",
            "ì¬ë¬¼ìš´ì´ ë”°ë¥´ë‹ˆ, ê¸°íšŒë¥¼ ì¡ìœ¼ë¼.",
            "ì‚¬ì—…ì„ í™•ì¥í•´ë„ ì¢‹ìœ¼ë¦¬ë¼.",
        ],
        ActionDirection.MODERATE: [
            "ì‘ì€ ê¸ˆì•¡ìœ¼ë¡œ ì‹œì‘í•˜ë¼. í•œ ë²ˆì— ì „ë¶€ íˆ¬ìí•˜ì§€ ë§ë¼.",
            "ë¶„í•  ë§¤ìˆ˜ê°€ ì´ë¡­ëŠë‹ˆë¼. ë‚˜ëˆ„ì–´ ì ‘ê·¼í•˜ë¼.",
            "í¬ê²Œ ë²Œë ¤ê³  í•˜ì§€ ë§ê³ , ì‘ì€ ì´ìµì— ë§Œì¡±í•˜ë¼.",
        ],
        ActionDirection.PASSIVE: [
            "ì§€ê¸ˆì€ íˆ¬ìí•  ë•Œê°€ ì•„ë‹ˆë‹ˆë¼. ê¸°ë‹¤ë¦¬ë¼.",
            "ìƒˆë¡œìš´ íˆ¬ìëŠ” ì‚¼ê°€ë¼. ìˆëŠ” ê²ƒì„ ì§€í‚¤ë¼.",
            "ì†ì ˆë„ ë°©ë²•ì´ë‹ˆë¼. ì†ì‹¤ì„ í‚¤ìš°ì§€ ë§ë¼.",
        ],
        ActionDirection.RETREAT: [
            "íˆ¬ìë¥¼ ë©ˆì¶”ë¼. ë” ë“¤ì–´ê°€ë©´ í™”ê°€ ì»¤ì§€ëŠë‹ˆë¼.",
            "ì§€ê¸ˆì€ í˜„ê¸ˆì„ ì§€í‚¬ ë•Œë‹ˆë¼. ìš•ì‹¬ì„ ë²„ë¦¬ë¼.",
            "ì†ì‹¤ì„ ì¸ì •í•˜ê³  ë¹ ì ¸ë‚˜ì˜¤ë¼. ë‹¤ìŒ ê¸°íšŒë¥¼ ë„ëª¨í•˜ë¼.",
        ],
    },

    # ğŸ’¼ ì§ì—…/ì´ì§
    "ì§ì—…": {
        ActionDirection.AGGRESSIVE: [
            "ì´ì§/ì „ì§í•˜ê¸° ì¢‹ì€ ë•Œë‹ˆë¼. ì ê·¹ì ìœ¼ë¡œ ì›€ì§ì´ë¼.",
            "ìƒˆë¡œìš´ ê¸°íšŒê°€ ì—´ë¦¬ë‹ˆ, ë„ì „í•˜ë¼.",
            "ì—°ë´‰ í˜‘ìƒ, ìŠ¹ì§„ ìš”ì²­í•´ë„ ì¢‹ìœ¼ë¦¬ë¼.",
        ],
        ActionDirection.MODERATE: [
            "ì¤€ë¹„ë¥¼ ë” í•˜ë©´ì„œ ê¸°íšŒë¥¼ ì‚´í”¼ë¼.",
            "ì´ì§ì€ ì¡°ê¸ˆ ë” ì•Œì•„ë³´ê³  ê²°ì •í•˜ë¼.",
            "ì‘ì€ ë³€í™”ë¶€í„° ì‹œë„í•˜ë¼. ê¸‰ê²©í•œ ë³€í™”ëŠ” ì‚¼ê°€ë¼.",
        ],
        ActionDirection.PASSIVE: [
            "ì§€ê¸ˆì€ í˜„ ì§ì¥ì„ ì§€í‚¬ ë•Œë‹ˆë¼. ì´ì§ì€ ì‚¼ê°€ë¼.",
            "ìƒˆ ì¼ì„ ì‹œì‘í•˜ê¸°ë³´ë‹¤ ìˆëŠ” ì¼ì— ì¶©ì‹¤í•˜ë¼.",
            "ë•Œë¥¼ ê¸°ë‹¤ë¦¬ë¼. ì„±ê¸‰í•œ í‡´ì‚¬ëŠ” í›„íšŒë¥¼ ë¶€ë¥´ëŠë‹ˆë¼.",
        ],
        ActionDirection.RETREAT: [
            "í° ë³€í™”ëŠ” ì‚¼ê°€ë¼. í˜„ ìƒíƒœë¥¼ ìœ ì§€í•˜ë¼.",
            "ì°½ì—…/ì‚¬ì—…í™•ì¥ì€ ë©ˆì¶”ë¼. ë¦¬ìŠ¤í¬ê°€ í¬ë‹ˆë¼.",
            "ë¬´ë¦¬í•œ ë„ì „ë³´ë‹¤ ì•ˆì •ì„ íƒí•˜ë¼.",
        ],
    },

    # ğŸ’• ì—°ì• /ê´€ê³„
    "ì—°ì• ": {
        ActionDirection.AGGRESSIVE: [
            "ê³ ë°±í•˜ê¸° ì¢‹ì€ ë•Œë‹ˆë¼. ë§ˆìŒì„ ì „í•˜ë¼.",
            "ì ê·¹ì ìœ¼ë¡œ ë‹¤ê°€ê°€ë¼. ì¸ì—°ì´ ì—´ë¦¬ë¦¬ë¼.",
            "í”„ë¡œí¬ì¦ˆ, ê²°í˜¼ ì¶”ì§„í•´ë„ ì¢‹ìœ¼ë¦¬ë¼.",
        ],
        ActionDirection.MODERATE: [
            "ì²œì²œíˆ ë‹¤ê°€ê°€ë¼. ê¸‰í•˜ë©´ ìƒëŒ€ê°€ ë¶€ë‹´ ëŠë¼ë¦¬ë¼.",
            "ì‘ì€ í˜¸ê° í‘œì‹œë¶€í„° ì‹œì‘í•˜ë¼.",
            "ë•Œë¥¼ ì‚´í”¼ë©° ì¡°ì‹¬ìŠ¤ëŸ½ê²Œ ì ‘ê·¼í•˜ë¼.",
        ],
        ActionDirection.PASSIVE: [
            "ì§€ê¸ˆì€ ê¸°ë‹¤ë¦´ ë•Œë‹ˆë¼. ë¨¼ì € ë‹¤ê°€ê°€ì§€ ë§ë¼.",
            "ê°ì •ì„ ì•ì„¸ìš°ë©´ ê·¸ë¥´ì¹˜ëŠë‹ˆë¼. ì´ì„±ì ìœ¼ë¡œ í–‰ë™í•˜ë¼.",
            "ìƒëŒ€ì˜ ë§ˆìŒì´ ì—´ë¦´ ë•Œê¹Œì§€ ì°¸ê³  ê¸°ë‹¤ë¦¬ë¼.",
        ],
        ActionDirection.RETREAT: [
            "ì§€ê¸ˆì€ ì—°ì• ë³´ë‹¤ ìì‹ ì„ ëŒë³¼ ë•Œë‹ˆë¼.",
            "ë¬´ë¦¬í•œ ì ‘ê·¼ì€ ê´€ê³„ë¥¼ ë§ì¹˜ëŠë‹ˆë¼. ë¬¼ëŸ¬ë‚˜ë¼.",
            "ì´ë³„ì„ ê³ ë¯¼ ì¤‘ì´ë¼ë©´, ê²°ì •ì„ ì„œë‘ë¥´ì§€ ë§ë¼.",
        ],
    },

    # ğŸ“š í•™ì—…/ì‹œí—˜
    "í•™ì—…": {
        ActionDirection.AGGRESSIVE: [
            "ì‹œí—˜ìš´ì´ ì¢‹ìœ¼ë‹ˆ, ìì‹ ê°ì„ ê°€ì§€ë¼.",
            "ë„ì „ì ì¸ ëª©í‘œë¥¼ ì„¸ì›Œë„ ì¢‹ìœ¼ë¦¬ë¼.",
            "ì‹¤ë ¥ì„ ë°œíœ˜í•  ë•Œë‹ˆë¼. ìµœì„ ì„ ë‹¤í•˜ë¼.",
        ],
        ActionDirection.MODERATE: [
            "ê¸°ë³¸ì— ì¶©ì‹¤í•˜ë¼. ë¬´ë¦¬í•œ ëª©í‘œëŠ” ì‚¼ê°€ë¼.",
            "ì°¨ê·¼ì°¨ê·¼ ì¤€ë¹„í•˜ë©´ ì¢‹ì€ ê²°ê³¼ ìˆìœ¼ë¦¬ë¼.",
            "ì»¨ë””ì…˜ ê´€ë¦¬ì— ì‹ ê²½ ì“°ë¼.",
        ],
        ActionDirection.PASSIVE: [
            "ì‹œí—˜ì„ ì—°ê¸°í•  ìˆ˜ ìˆë‹¤ë©´ ë¯¸ë£¨ëŠ” ê²ƒë„ ë°©ë²•ì´ë‹ˆë¼.",
            "ë¬´ë¦¬í•˜ì§€ ë§ê³  í•  ìˆ˜ ìˆëŠ” ë§Œí¼ë§Œ í•˜ë¼.",
            "ê²°ê³¼ì— ë„ˆë¬´ ê¸°ëŒ€í•˜ì§€ ë§ë¼. ë‹¤ìŒ ê¸°íšŒë¥¼ ë„ëª¨í•˜ë¼.",
        ],
        ActionDirection.RETREAT: [
            "ì§€ê¸ˆì€ ì‰¬ì–´ê°ˆ ë•Œë‹ˆë¼. ë¬´ë¦¬í•˜ë©´ ê±´ê°•ì„ í•´ì¹˜ëŠë‹ˆë¼.",
            "ëª©í‘œë¥¼ ë‚®ì¶”ëŠ” ê²ƒë„ ì§€í˜œë‹ˆë¼.",
            "ì´ë²ˆì´ ì•„ë‹ˆì–´ë„ ê´œì°®ëŠë‹ˆë¼. ê¸¸ê²Œ ë³´ë¼.",
        ],
    },

    # ğŸ¥ ê±´ê°•
    "ê±´ê°•": {
        ActionDirection.AGGRESSIVE: [
            "ê±´ê°•ìš´ì´ ì¢‹ìœ¼ë‹ˆ, ìƒˆë¡œìš´ ìš´ë™/ê±´ê°•ê´€ë¦¬ë¥¼ ì‹œì‘í•˜ë¼.",
            "ìˆ˜ìˆ /ì‹œìˆ ì„ ê³ ë ¤ ì¤‘ì´ë¼ë©´ ì§„í–‰í•´ë„ ì¢‹ìœ¼ë¦¬ë¼.",
            "ëª¸ì´ íšŒë³µë˜ëŠ” ê¸°ìš´ì´ë‹ˆ, ì ê·¹ì ìœ¼ë¡œ í™œë™í•˜ë¼.",
        ],
        ActionDirection.MODERATE: [
            "ë¬´ë¦¬í•˜ì§€ ì•ŠëŠ” ì„ ì—ì„œ ê´€ë¦¬í•˜ë¼.",
            "ê¸‰ê²©í•œ ë³€í™”ë³´ë‹¤ ê¾¸ì¤€í•œ ê´€ë¦¬ê°€ ì´ë¡­ëŠë‹ˆë¼.",
            "ì „ë¬¸ê°€ì˜ ì¡°ì–¸ì„ ë”°ë¥´ë¼.",
        ],
        ActionDirection.PASSIVE: [
            "ë¬´ë¦¬í•œ í™œë™ì€ ì‚¼ê°€ë¼. íœ´ì‹ì´ í•„ìš”í•œ ë•Œë‹ˆë¼.",
            "í° ì‹œìˆ /ìˆ˜ìˆ ì€ ë¯¸ë£¨ëŠ” ê²ƒì´ ì¢‹ìœ¼ë¦¬ë¼.",
            "ëª¸ì˜ ì†Œë¦¬ì— ê·€ ê¸°ìš¸ì´ë¼.",
        ],
        ActionDirection.RETREAT: [
            "ì ˆëŒ€ ë¬´ë¦¬í•˜ì§€ ë§ë¼. ê±´ê°•ì´ ìµœìš°ì„ ì´ë‹ˆë¼.",
            "ì¦‰ì‹œ ì „ë¬¸ê°€ë¥¼ ì°¾ìœ¼ë¼. ë¯¸ë£¨ì§€ ë§ë¼.",
            "ëª¨ë“  ê²ƒì„ ë‚´ë ¤ë†“ê³  ì‰¬ì–´ë¼.",
        ],
    },
}


# ============================================================================
# ìœ ëª… íš¨ì‚¬ í•´ì„ ì˜ˆì‹œ (ìì£¼ ì¸ìš©ë˜ëŠ” ê²ƒë“¤)
# ============================================================================

FAMOUS_YAO_INTERPRETATIONS: Dict[str, Dict] = {
    # ê±´ê´˜(ä¹¾å¦) íš¨ì‚¬
    "ì ë£¡ë¬¼ìš©": {
        "original": "æ½›é¾å‹¿ç”¨",
        "hexagram": 1,
        "yao": "ì´ˆêµ¬",
        "meaning": "ìš©ì´ ë¬¼ì— ì ê²¼ìœ¼ë‹ˆ ì“°ì§€ ë§ë¼",
        "interpretation": "ì•„ì§ ë•Œê°€ ì•„ë‹ˆë‹ˆ ê¸°ë‹¤ë¦¬ë¼ëŠ” í•˜ëŠ˜ì˜ ëœ»ì´ë‹ˆë¼. ì„±ê¸‰í•˜ê²Œ ì¶”ì§„í•˜ë©´ í•˜ë˜ ì¼ë„ ê·¸ë¥´ì¹˜ê²Œ ë˜ë‹ˆ, ì¡°ê¸ˆ ê¸°ë‹¤ë¦¬ë¼ëŠ” ëœ»ì´ ë‚´í¬ë˜ì–´ ìˆëŠë‹ˆë¼.",
        "direction": ActionDirection.PASSIVE,
    },
    "ê²¬ë£¡ì¬ì „": {
        "original": "è¦‹é¾åœ¨ç”° åˆ©è¦‹å¤§äºº",
        "hexagram": 1,
        "yao": "êµ¬ì´",
        "meaning": "ìš©ì´ ë°­ì— ë‚˜íƒ€ë‚¬ìœ¼ë‹ˆ ëŒ€ì¸ì„ ë§Œë‚˜ë©´ ì´ë¡­ë‹¤",
        "interpretation": "ë•Œê°€ ì˜¤ê¸° ì‹œì‘í–ˆìœ¼ë‹ˆë¼. ëŠ¥ë ¥ ìˆëŠ” ì‚¬ëŒì˜ ë„ì›€ì„ êµ¬í•˜ë©´ ëœ»ì„ ì´ë£¨ë¦¬ë¼.",
        "direction": ActionDirection.MODERATE,
    },
    "êµ°ìì¢…ì¼ê±´ê±´": {
        "original": "å›å­çµ‚æ—¥ä¹¾ä¹¾ å¤•æƒ•è‹¥å² ç„¡å’",
        "hexagram": 1,
        "yao": "êµ¬ì‚¼",
        "meaning": "êµ°ìê°€ ì¢…ì¼ í˜ì“°ê³  ì €ë…ì—ë„ ë‘ë ¤ì›Œí•˜ë©´ í—ˆë¬¼ì´ ì—†ë‹¤",
        "interpretation": "ëŠì„ì—†ì´ ë…¸ë ¥í•˜ê³  ê²½ê³„ë¥¼ ê²Œì„ë¦¬í•˜ì§€ ì•Šìœ¼ë©´ íƒˆì´ ì—†ìœ¼ë¦¬ë¼. ìë§Œí•˜ì§€ ë§ê³  ì •ì§„í•˜ë¼ëŠ” ëœ»ì´ë‹ˆë¼.",
        "direction": ActionDirection.MODERATE,
    },
    "ë¹„ë£¡ì¬ì²œ": {
        "original": "é£›é¾åœ¨å¤© åˆ©è¦‹å¤§äºº",
        "hexagram": 1,
        "yao": "êµ¬ì˜¤",
        "meaning": "ë‚˜ëŠ” ìš©ì´ í•˜ëŠ˜ì— ìˆìœ¼ë‹ˆ ëŒ€ì¸ì„ ë§Œë‚˜ë©´ ì´ë¡­ë‹¤",
        "interpretation": "ìµœê³ ì˜ ë•Œê°€ ì™”ìœ¼ë‹ˆë¼. ëœ»í•œ ë°”ë¥¼ í–‰í•˜ë©´ í¬ê²Œ ì´ë£¨ë¦¬ë¼. ì ê·¹ì ìœ¼ë¡œ ë‚˜ì•„ê°€ë¼.",
        "direction": ActionDirection.AGGRESSIVE,
    },
    "í•­ë£¡ìœ íšŒ": {
        "original": "äº¢é¾æœ‰æ‚”",
        "hexagram": 1,
        "yao": "ìƒêµ¬",
        "meaning": "ë†’ì´ ì˜¤ë¥¸ ìš©ì€ í›„íšŒê°€ ìˆë‹¤",
        "interpretation": "ë„ˆë¬´ ë†’ì´ ì˜¬ë¼ ë” ì´ìƒ ì˜¤ë¥¼ ê³³ì´ ì—†ëŠë‹ˆë¼. ì§€ë‚˜ì¹¨ì€ ëª¨ìëŒë§Œ ëª»í•˜ë‹ˆ, ë¬¼ëŸ¬ë‚¨ì„ ì•Œì•„ì•¼ í•˜ëŠë‹ˆë¼.",
        "direction": ActionDirection.RETREAT,
    },

    # ê³¤ê´˜(å¤å¦) íš¨ì‚¬
    "ì´ë¹™ì§€": {
        "original": "å±¥éœœ å …å†°è‡³",
        "hexagram": 2,
        "yao": "ì´ˆìœ¡",
        "meaning": "ì„œë¦¬ë¥¼ ë°Ÿìœ¼ë©´ ë‹¨ë‹¨í•œ ì–¼ìŒì´ ì´ë¥¸ë‹¤",
        "interpretation": "ì‘ì€ ì§•ì¡°ë¥¼ ì‚´í”¼ë¼. ì¡°ì§ì„ ë¬´ì‹œí•˜ë©´ í° í™”ê°€ ë˜ëŠë‹ˆë¼. ë¯¸ë¦¬ ëŒ€ë¹„í•˜ë¼ëŠ” ëœ»ì´ë‹ˆë¼.",
        "direction": ActionDirection.PASSIVE,
    },

    # ìˆ˜ì²œìˆ˜(æ°´å¤©éœ€) ê´˜ì‚¬
    "ìˆ˜ìœ ë¶€": {
        "original": "éœ€ æœ‰å­š å…‰äº¨ è²å‰",
        "hexagram": 5,
        "yao": "ê´˜ì‚¬",
        "meaning": "ê¸°ë‹¤ë¦¼ì— ë¯¿ìŒì´ ìˆìœ¼ë©´ í¬ê²Œ ë°ê³  í˜•í†µí•˜ë‹ˆ ë°”ë¥´ë©´ ê¸¸í•˜ë‹¤",
        "interpretation": "ì§€ê¸ˆì€ ê¸°ë‹¤ë¦¼ì´ í•„ìš”í•œ ë•Œë‹ˆë¼. ë¯¿ìŒì„ ìƒì§€ ì•Šê³  ë•Œë¥¼ ê¸°ë‹¤ë¦¬ë©´ ë°˜ë“œì‹œ í˜•í†µí•˜ë¦¬ë¼.",
        "direction": ActionDirection.PASSIVE,
    },
}


# ============================================================================
# ìš´ì„¸ ì ìˆ˜ â†’ ë“±ê¸‰ ë³€í™˜
# ============================================================================

def score_to_fortune_level(score: int) -> FortuneLevel:
    """ì ìˆ˜ë¥¼ ìš´ì„¸ ë“±ê¸‰ìœ¼ë¡œ ë³€í™˜"""
    if score >= 90:
        return FortuneLevel.GREAT_FORTUNE
    elif score >= 75:
        return FortuneLevel.FORTUNE
    elif score >= 60:
        return FortuneLevel.SMALL_FORTUNE
    elif score >= 45:
        return FortuneLevel.NEUTRAL
    elif score >= 30:
        return FortuneLevel.SMALL_MISFORTUNE
    elif score >= 15:
        return FortuneLevel.MISFORTUNE
    else:
        return FortuneLevel.GREAT_MISFORTUNE


def get_action_direction(fortune_level: FortuneLevel) -> ActionDirection:
    """ìš´ì„¸ ë“±ê¸‰ì—ì„œ í–‰ë™ ë°©í–¥ ë„ì¶œ"""
    return FORTUNE_TO_ACTION[fortune_level]


def get_action_template(direction: ActionDirection) -> Dict:
    """í–‰ë™ ë°©í–¥ì— ë§ëŠ” í…œí”Œë¦¿ ë°˜í™˜"""
    return ACTION_TEMPLATES[direction]


def get_category_guide(category: str, direction: ActionDirection) -> List[str]:
    """ì¹´í…Œê³ ë¦¬ì™€ í–‰ë™ë°©í–¥ì— ë§ëŠ” êµ¬ì²´ì  ê°€ì´ë“œ ë°˜í™˜"""
    # ì¹´í…Œê³ ë¦¬ ë§¤í•‘ (ì†Œë¶„ë¥˜ â†’ ëŒ€ë¶„ë¥˜)
    category_map = {
        "ì£¼ì‹": "ì¬ë¬¼", "ì½”ì¸": "ì¬ë¬¼", "ë¶€ë™ì‚°": "ì¬ë¬¼", "ë³µê¶Œ": "ì¬ë¬¼",
        "ì°½ì—…": "ì¬ë¬¼", "ì‚¬ì—…": "ì¬ë¬¼", "íˆ¬ì": "ì¬ë¬¼",
        "ì·¨ì—…": "ì§ì—…", "ì´ì§": "ì§ì—…", "ë©´ì ‘": "ì§ì—…", "ìŠ¹ì§„": "ì§ì—…",
        "ì—°ë´‰": "ì§ì—…", "í‡´ì‚¬": "ì§ì—…",
        "ì¸": "ì—°ì• ", "ê³ ë°±": "ì—°ì• ", "ê²°í˜¼": "ì—°ì• ", "ì´ë³„": "ì—°ì• ",
        "ì§ì‚¬ë‘": "ì—°ì• ", "ì†Œê°œíŒ…": "ì—°ì• ",
        "ìˆ˜ëŠ¥": "í•™ì—…", "ì‹œí—˜": "í•™ì—…", "ìê²©ì¦": "í•™ì—…", "ê³µë¬´ì›": "í•™ì—…",
        "ìˆ˜ìˆ ": "ê±´ê°•", "ë‹¤ì´ì–´íŠ¸": "ê±´ê°•", "ì§ˆë³‘": "ê±´ê°•",
    }

    major_category = category_map.get(category, category)

    if major_category in CATEGORY_ACTION_GUIDE:
        return CATEGORY_ACTION_GUIDE[major_category].get(direction, [])

    return []


# ============================================================================
# í…ŒìŠ¤íŠ¸
# ============================================================================

if __name__ == "__main__":
    print("\n" + "="*60)
    print("ğŸ”® ìš´ì„¸ ë°©í–¥ë³„ í•´ì„ ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸")
    print("="*60)

    test_cases = [
        (95, "ì¬ë¬¼"),   # ëŒ€ê¸¸ + ì¬ë¬¼
        (72, "ì—°ì• "),   # ì†Œê¸¸ + ì—°ì• 
        (35, "ì§ì—…"),   # ì†Œí‰ + ì§ì—…
        (10, "ê±´ê°•"),   # ëŒ€í‰ + ê±´ê°•
    ]

    for score, category in test_cases:
        level = score_to_fortune_level(score)
        direction = get_action_direction(level)
        template = get_action_template(direction)
        guides = get_category_guide(category, direction)

        print(f"\nğŸ“Š ì ìˆ˜: {score}ì  | ë“±ê¸‰: {level.value} | ë°©í–¥: {direction.value}")
        print(f"   ì¹´í…Œê³ ë¦¬: {category}")
        print(f"   ë°©í–¥ ì•ˆë‚´: {template['direction_intro'][0]}")
        print(f"   í–‰ë™ ì§€ì¹¨: {template['action_guide'][0]}")
        if guides:
            print(f"   êµ¬ì²´ ê°€ì´ë“œ: {guides[0]}")
